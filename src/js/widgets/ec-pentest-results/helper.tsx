import dayjs from "dayjs";
import { SeriesDataType, TooltipParams } from "./types";

export function tooltipFormatter(params: TooltipParams, point: SeriesDataType) {
  // Extract pentest details from rawData based on your JSON structure
  const rawData = point.rawData || [];
  const port = rawData[0] || "N/A";
  const vulnerability = rawData[1] || "N/A";
  const description = rawData[2] || "N/A";
  const cve = rawData[3] || "N/A";
  const cvssBase = rawData[4] || "N/A";
  const severity = rawData[5] || "N/A";
  const solution = rawData[6] || "N/A";
  const service = rawData[7] || "N/A";

  let tooltipContent = `<strong>Pentest Result</strong><br/>`;
  tooltipContent += `<strong>Date:</strong> ${dayjs(
    new Date(point.date)
  ).format("DD.MM.YY HH:mm:ss")}<br/>`;

  if (port !== "N/A" && port !== "") {
    tooltipContent += `<strong>Port:</strong> ${port}<br/>`;
  }

  if (service !== "N/A" && service !== "") {
    tooltipContent += `<strong>Service:</strong> ${service}<br/>`;
  }

  if (vulnerability !== "N/A" && vulnerability !== "") {
    tooltipContent += `<strong>Vulnerability:</strong> ${vulnerability}<br/>`;
  }

  if (cve !== "N/A" && cve !== "") {
    tooltipContent += `<strong>CVE:</strong> ${cve}<br/>`;
  }

  if (cvssBase !== "N/A" && cvssBase !== "") {
    tooltipContent += `<strong>CVSS Base:</strong> ${cvssBase}<br/>`;
  }

  if (severity !== "N/A" && severity !== "") {
    tooltipContent += `<strong>Severity:</strong> ${severity}<br/>`;
  }

  if (description !== "N/A" && description !== "") {
    tooltipContent += `<strong>Description:</strong> ${description}<br/>`;
  }

  if (solution !== "N/A" && solution !== "") {
    tooltipContent += `<strong>Solution:</strong> ${solution}`;
  }

  return tooltipContent;
}
